در این مثال
ما یه سرور خارج داریم که openVPN با پورت 1194 روش نصب هست و ما نمیتونیم بهش دسترسی مستقیم داشته باشیم 

حالا ما میخوایم با استفاده از سرور ایران ، هر چی درخواست به سرورمون روی پورت 3840 ارسال میشه رو از طریق پروتوکل gRPC بفرستیم روی پورت 1194 آی پی 222.222.222.222




## سرور داخلی

###### پروتوکل gRPC

```
gost -L=grpc://:3840/222.222.222.222:1194
```
##### پروتوکل tcp

```
gost -L=tcp://:3840/222.222.222.222:1194
```


سرویس گوست منتظر میمونه که براش روی پورت 3840 اطلاعات ارسال بشه
بعد تمامی اطلاعات از این پورت رو میگیره و انتقال میده روی آی پی 222.222.222.22 روی پورت 1194 که سرور اپن وی پی ان روش نصب هست.

نکته ای که هست اینه که ما باید توی تنظیمات فایل openvpn وقتی آی پی ایران رو میذاریم باید پورت رو هم از 1194 به 3840 تغییر بدیم.


###### برای آی پی نسخه 6

باید حتما openVPN سرور یا وایرگارد سرور باید از آی پی نسخه 6 ساپورت کنند.
پروتوکل وایرگارد udp هست


----

اگر بخواهیم ترافیک را از طریق پورت خاصی بین دو سرور عبور بدیم میتونیم از روش تونل استفاده کنیم

### 01 - تونل معمولی
#### SERVER خارج 
```

gost -L relay://:9000
```
روی سرور خارج گوست رو روی پورت 9000 اجرا میکنیم که منتظر دریافت اطلاعات روی این پورت بمونه

### SERVER داخل

```
gost -L tcp://:3840/222.222.222.222:1194  -F  relay://222.222.222.222:9000
```

روی سرور ایران، هر چی دیتای tcp هست رو از پورت 3840 میگیره و منتقلش میکنه رو پورت 1194 برا سرور  و این دیتا از طریق تونل روی پورت 9000 برای سرور فرستاده میشه.

...

### 02 - تونل با استفاده از otls
#### SERVER KHAREJ

```
gost -L relay+otls://:9000/:1194
```
توی این دستور یه کم تغییرات اجرا کردیم و با این دستور توی سرور خارج میگیم که هر درخواستی که روی 9000 اومد رو بفرست برا 1194، تونل ارتباطی هم از نوع `otls` هست.

.

### SERVER IRAN
```
gost  -L tcp://:1194/SERVER_KHAREJ -F relay+otls://SERVER_KHAREJ:9000
```
با این دستور توی سرور ایران، میگیم که تمای ورودی های پورت 1194 رو بفرست برای تونل `otls` رو پورت 9000 سرور خارج

وقتی تونل `otls` برقرار میشه، سرور خارج تمامی درخواست ها رو از پورت 9000 میگیره و میفرسته برا پورت 1194


---
### 03 - تونل با استفاده از mtls
#### SERVER KHAREJ

```
gost -L relay+mtls://:9000/:1194
```

این دستور هم شبیه خط قبل هست فقط نوع تونل گوست فرق میکنه و mtls هست
.

### SERVER IRAN

```
 gost  -L tcp://:1194/SERVER_KHAREJ -F relay+mtls://SERVER_KHAREJ:9000

```
